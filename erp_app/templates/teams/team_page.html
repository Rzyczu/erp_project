{% load static %}
{% load project_permissions %}

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{ team.name }}</title>
    <link href="{% static 'styles/styles.css' %}" rel="stylesheet" />
  </head>
  <body>
    <h1>Team {{ team.name }}</h1>
    <p>Description: {{ team.description }}</p>

    <p>
        Project Manager:
        {% for member in team_members %}
          {% if member.role == 'project_manager' %}
          {{ member.user.username }} ({{ member.user.get_full_name }})
          {% endif %}
        {% empty %}
          No project manager assigned.
        {% endfor %}
      </p>

    <h2>Team Members</h2>
    <ul>
      {% for member in team_members %}
      <li>
        {{ member.user.username }} ({{ member.user.get_full_name }}) - {{member.get_role_display }}
      </li>
      {% empty %}
        No members assigned.
      {% endfor %}
    </ul>

    <h2>Projects</h2>
    <ul>
        {% for project in projects %}
        <li>
            {{ project.name }} -
            <a href="{% url 'project_page_view' project.id %}">Select project</a>
        </li>
        {% empty %}
        No projects assigned.
        {% endfor %}
    </ul>

    {# Set a variable to check if the user is a project manager for this team #}
    {% is_project_manager request.user team.id as is_pm %}
    
    {% if is_pm %}
        <a href="{% url 'add_project_view' team.id %}">Add Project</a>
    {% endif %}
    <a href="{% url 'dashboard' %}">Back to Dashboard</a>
  </body>
</html>
